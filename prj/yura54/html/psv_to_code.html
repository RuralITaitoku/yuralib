<!doctype html>
<html lang="ja">
    <head>
        <meta charset="UTF-8" />
        <title>PVS Generator</title>
        <style>
            body {
                font-family: sans-serif;
                padding: 20px;
                max-width: 900px;
                margin: auto;
                background: #f4f7f9;
            }
            .container {
                background: white;
                padding: 20px;
                border-radius: 8px;
                box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            }
            textarea {
                width: 100%;
                height: 120px;
                font-family: monospace;
                margin-bottom: 15px;
                border: 1px solid #ccc;
                border-radius: 4px;
                padding: 8px;
                box-sizing: border-box;
            }
            .label {
                font-weight: bold;
                margin-bottom: 5px;
                display: block;
            }
            button {
                padding: 12px 24px;
                cursor: pointer;
                background: #28a745;
                color: white;
                border: none;
                border-radius: 4px;
                font-size: 16px;
            }
            button:hover {
                background: #218838;
            }
            .help {
                font-size: 0.9em;
                color: #666;
                margin-bottom: 15px;
            }
            #output {
                background: #e9ecef;
                height: 200px;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <h2>PVS コード生成ツール</h2>

            <span class="label">1. 元データ (PVS形式)</span>
            <div class="help">例: 101|田中|営業部</div>
            <textarea id="inputData" placeholder="ID|名前|部署"></textarea>

            <span class="label">2. ひな形 (Template)</span>
            <div class="help">各列を $1, $2, $3... で指定してください。</div>
            <textarea
                id="template"
                placeholder="INSERT INTO users (id, name, dept) VALUES ('$1', '$2', '$3');"
            ></textarea>

            <button onclick="generate()">コードを生成</button>

            <hr />

            <span class="label">3. 生成結果</span>
            <textarea id="output" readonly></textarea>
        </div>

        <script>
            function generate() {
                const input = document.getElementById("inputData").value.trim();
                const template = document.getElementById("template").value;
                if (!input || !template)
                    return alert("データとひな形を入力してください");

                const lines = input.split("\n");
                const result = lines.map((line) => {
                    const columns = line.split("|");
                    let temp = template;
                    columns.forEach((val, index) => {
                        // $1, $2... を対応する列の内容で置換
                        const placeholder = new RegExp(
                            "\\$" + (index + 1),
                            "g",
                        );
                        temp = temp.replace(placeholder, val.trim());
                    });
                    return temp;
                });

                document.getElementById("output").value = result.join("\n");
            }
        </script>
    </body>
</html>
